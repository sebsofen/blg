Ein Wegenetz soll aus einzelnen, sich überschneidenen Tracks, erstellt werden.

Die Tracks sind csv exports aus der *MyTracks* App:

Das Format ist trivial:

```
"Name","Activity type","Description"
"Abraham 7","walking",""

"Segment","Point","Latitude (deg)","Longitude (deg)","Altitude (m)","Bearing (deg)","Accuracy (m)","Speed (m/s)","Time","Power (W)","Cadence (rpm)","Heart rate (bpm)"
"1","1","53.139893","8.211804","62.0","313.0","15","1.5811","2015-06-27T09:20:51.946Z","","",""
"1","2","53.139905","8.211942","31.0","354.0","17","2.5495","2015-06-27T09:21:17.037Z","","",""
...
"1","1457","53.139025","8.210837","45.0","","11","0","2015-06-27T10:16:27.161Z","","",""
"1","1458","53.139024","8.210841","45.0","","11","0","2015-06-27T10:16:28.166Z","","",""
"1","1459","53.139017","8.210853","48.0","","11","0","2015-06-27T10:16:53.535Z","","",""
```

Zum parsen und verarbeiten eignet sich python mit dem ```shapely``` package bestens:


```
import argparse
import csv
from shapely.geometry import LineString
import matplotlib.pyplot as plt
def main():
	args = parse_args()

	coords = []
	polys = []
	for file in args.data:
		with open(file, "rb") as csvfile:
			poly = []
			coord = csv.reader(csvfile, delimiter=",", quotechar='"')
			coordrow = False
			for row in coord:
				if coordrow == True:
					poly.append((float(row[2]),float(row[3])))

				if len(row) > 1 and row[0] == "Segment":
					coordrow = True
			polys.append(LineString(poly))

	#find intersecting points
	#find way between intersections for all given routes
	intersections = polys[0].intersection(polys[1])
	fig, ax = plt.subplots()
	ax.hold(True)
	x,y = polys[0].xy
	ax.plot(x,y,"-",color = "green")

	x,y = polys[1].xy
	ax.plot(x,y,"-",color = "red")

	#print intersections
	for intersect in intersections:
		ax.plot(intersect.x,intersect.y,"o",color = "black")
	plt.show()


def parse_args():
  """Parse the command line arguments"""
  parser = argparse.ArgumentParser(
      description='Plot the data generated by gather_data')
  # add arguments here
  parser.add_argument('--data', nargs='+', dest='data', type=str,
                      help="json file containing the gathered data", required=True)
  return parser.parse_args()




if __name__ == "__main__":
	main()
```


Aus den gelesenen Zeilen werden Latitude und Longitude extrahiert.
Die Koordinaten werden dann zu einem "LineString" zusammengefügt.
Mithilfe von shapely können nun die die gelesenen LineStrings analysiert werden.
Bei Gelegenheit wird das auch noch automatisiert und nicht nur die ersten beiden miteinander verglichen.

Ausgabe der "intersect" analyse sind neue Koordinaten, an denen sich Abschnitte der beiden Tracks überschneiden.
Schnell mit matplotlib visualisiert, sieht das dann so aus:

![Intersections](python_polygone/intersects.png)
